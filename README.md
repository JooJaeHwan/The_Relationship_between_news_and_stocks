# The_Relationship_between_news_and_stocks
사용자가 뉴스기사를 입력했을 때 인공지능 모델 기반으로 주가 등락 예측 결과를 보여주는 서비스
# 데이터 개요 및 수집
- 경제 뉴스 기사가 주식 등락에 얾나 큰 영향을 주는지 알아보기 위해 다양한 인공지능 모델들의 성능을 비교해보고 가장 좋은 성능의 모델로 서비스를 제공
- 뉴스기사를 데이터로 선정한 이유는 다른 커뮤니티의 댓글들에 비해 주식에 관한 내용이 정직하게 담겨져 있고 비교적 데이터를 얻기 수월하기 때문에 데이터로 선정
- 데이터는 네이버 금융의 KOSPI 200에 속해 있는 200개의 종목의 2분기 일별 시세 ( 3월 31일 ~ 7월 18일 ) 와 뉴스기사 데이터 약 11만개를 셀레리움을 통해 크롤링
# 데이터 전처리
- 뉴스기사에 영어로 표기된 중요한 경제용어가 포함되어있을 수 있고, 숫자도 영향을 줄 수 있다고 판단하여 일부 특수문자를 제외한 모든 특수문자와 불용어 제거
- 국내 주식 시장 거래 활성화 시간 18시를 기준으로 18시 이전에 발행된 기사들은 당일 시가와 당일 종가를 비교하여 라벨링을 작성
- 18시 이후애 발행된 기사들은 당일 종가와 후일 시가를 비교하여 라벨링을 작성
- 휴일 같은 경우 휴일 전날 18시 이후에 발행된 기사들과 휴일 당일에 발행된 기사들은 휴일 전날 종가와 휴일이 끝나는 다음날 시가를 비교하여 라벨링을 작성
- Tokenizer의 경우 Konlpy의 Kkma, Okt, Mecab와 NLTK의 Word_tokenize 4가지를 사용하여 성능 비교
- 속도 Mecab < NLTK < Okt < Kkma 성능에서는 미미한 차이를 보임
- Kkma로 진행 중 모델 경량화를 위해 사용하기 편리하고 속도적으로도 유리한 Okt로 변경
# 모델링
- 딥러닝 ( TextCNN, LSTM, 양방향 LSTM, GRU, 양방향 GRU ) 5가지 머신러닝 ( XGBoost ) 1가지 공부 후 딥러닝 모델 (양방향 LSTM, 양방향 GRU, TextCNN ) 3가지 머신러닝 모델 ( XGBoost ) 1가지 사용하고 성능 비교 후 최적의 모델 적용
- 양방향 LSTM과 양방향 GRU의 경우 서로 성능을 비교하기 위해 선정하였고 기존 LSTM, GRU와는 달리 역방향을 처리하는 계층을 추가함으로써 과거의 정보만 기억할 수 있는 단방향과는 다르게 과거와 미래의 정보까지 기억할 수 있어 데이터의 길이가 길어져도 성능이 저하되지 않는 장점을 가짐
- TextCNN모델의 경우 2014년 발행된 논문 ( Convolutional Neural Networks for Sentence Classification )을 인용해서 사용
- XGBoost의 경우 좀 더 공부 후 수정이 필요!

|모델|양방향 LSTM|양방향 GRU|TextCNN|XGBoost|
|:------:|:--:|:--:|:--:|:--:|
|Accuracy|0.51|0.51|0.50|0.64|
|Loss(Binary CrossEntropy)|0.88|0.89|0.77| X |

- 4개의 성능을 비교했을 때 XGBoost가 가장 잘 나왔지만 완벽한 정확도라고 보기 어려운 점을 생각해 프로젝트 모델에서 제외
- 나머지 딥러닝 모델 3가지 다 성능이 비슷했지만 양방향 LSTM과 GRU의 경우 성능에 비해 Loss 값이 높아 과적합의 가능성이 있어 프로젝트 모델에서 제외
- NLP에서 일반적으로 사용하는 RNN 기반이 아닌 CNN 기반으로 만든 TextCNN이 가장 프로젝트 모델에 적합하다고 판단하고 프로젝트 모델로 선정
# 결과
- 사용자가 입력한 뉴스기사를 웹 서버 ( AWS 서버 ) 에서 받아와 모델 서버 ( 로컬 서버 ) 로 텍스트를 전송 후 모델 서버 ( 로컬 서버 ) 에서 처리 후 다시 웹 서버 ( AWS 서버 ) 로 전송 결과창을 사용자에게 출력
- 프로젝트 전체 기간 중에서 데이터 수집과 전처리 과정에서 반 이상이 소요됐던 점이 아쉬 웠음
- 컴퓨터 성능의 한계로 시도조차 해보지 못한 부분이 많음 ( 층을 더 깊게 쌓기, 더 많은 양의 데이터를 사용 등등 )
